<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <title>Mesh Path Detection Model</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="canvasclickcoords.js"></script>
    <script src="guid.js"></script>
    <script src="meshpath.js"></script>
  </head>
  <body id="body" onload="meshpath.init(512,512)">
    <label for="node_count"><input name="node_count" id="node_count" /></label> <input type="button" onclick="meshpath.create_nodes(document.getElementById('node_count').value); return 0;" value="Create Nodes" /> <input type="button" onclick="meshpath.wagumba(); return 0;" value="Find a Path" />
    <p>Click near nodes to set or unset the source or destination node.
    <ul id="vars"><li>Src: <span id="src">(none)</span><li>Dst: <span id="dst">(none)</span></ul>
    <div id="wtf">
      <div id="canvas_container">
      </div>
      <div id="router">
        Define two functions here: <em>Point.initiate(dst_guid)</em> and <em>Point.receive(recipient_guid, packet)</em>. <em>initiate</em> is called in the context of the source node (with guid <em>this.guid</em>) when you click Find a Path. <em>receive</em> is called when a node receives a packet. Call <em>broadcast(packet)</em> to send a packet to all nodes in your radius. Define <em>packet</em> according to your imagination.
        <textarea id="evalme">Point.prototype.initiate = function(dst_guid) {
    var packet = {};
    packet.src = this.guid;
    packet.dst = dst_guid;
    // packet.route = [];
    // packet.route.push(this.guid);
    packet.route_length = 0;
    return packet;
};

Point.prototype.receive = function(packet) {
    if (this.guid === packet.dst) {
        console.log("FOUND ME!!! Route:" + packet.route_length);
        return [];
    } else if (this.shortest_route === undefined || packet.route_length &lt; this.shortest_route) {
        // packet.route.push(this.guid);
        packet.route_length += 1;
        this.shortest_route = packet.route_length;
        return this.qt.broadcast(packet);
    } else {
        return [];
    }
};
</textarea>
      </div>
    </div>
    <div id="logging">
      Event log:
      <div id="innerlogging">
        <textarea id="logtome"></textarea>
      </div>
    </div>
  </body>
</html>

